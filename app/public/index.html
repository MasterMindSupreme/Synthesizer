<html>

<head>
    <title>Online Synthesizer</title>
    <link rel="stylesheet" href="components/knob.css">
    <link rel="stylesheet" href="components/volume.css">
    <link rel="stylesheet" href="components/toggle-button.css">
    <link rel="stylesheet" href="components/oscillator.css">
    <link rel="stylesheet" href="components/general.css">
    <link rel="stylesheet" href="components/open-sample.css">
    <link rel="stylesheet" href="components/waveform.css">
    <link rel="stylesheet" href="components/rate-comp.css">
    <link rel="stylesheet" href="components/freq-slider.css">
    <link rel="stylesheet" href="components/oscillator-dropdown.css">
    <!-- External Libraries -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/webmidi@latest/dist/iife/webmidi.iife.js"></script>
</head>

<body class="bg-gray-100 justify-center min-h-screen">
    <!-- Temporary play button for testing the initial sound environment -->
    <button id="play">
        play
    </button>
    <!-- Temporary input element with temporary values for testing the initial sound environment -->
    <input id="freq" type="range" min="4" max="7040" value="880" class="freq-slider">
    <main>
        <div style="display: flex; align-items: start;">
            <div id="oscillator">
                <div class="waveform">
                    <label id="waveformLabelLeft" class="wf-left">Sine</label>
                    <input type="range" id="waveformSlider" min="0" max="100" value="0" class="wf-slider">
                    <select id="waveformDropdown" class="wf-dropdown">
                        <option value="triangle">Triangle</option>
                        <option value="square">Square</option>
                        <option value="sawtooth">Sawtooth</option>
                    </select>
                </div>

                <div class="oscillator-power-toggle">
                    <button class="power-button active" id="oscillatorPower" data-type="OSC_POWER">
                        <img src="icons/on-button-icon-vector.png" alt="Power On" class="power-on-img">
                        <img src="icons/off-button-icon-vector.png" alt="Power Off" class="power-off-img">
                    </button>
                </div>

                <canvas id="oscillatorView" width="600px" height="100px"></canvas>
                <div class="flex flex-row">
                    <fieldset class="border-2 border-black w-[20] h-[130]">
                        <legend class="text-x1 font-bold text-black text-center px-2 p-0 m-0">Tune</legend>

                        <div id="tune-rack" class="flex flex-col items-center md:flex-row"></div>
                    </fieldset>
                    <div id="OSCVolume"></div>
                    <div class="button-container">
                        <div class="toggle-button" data-type="ENV1">ENV 1</div>
                        <div class="toggle-button" data-type="LFO1">LFO 1</div>
                        <div class="toggle-button" data-type="FILTER1">FILTER 1</div>
                        <div class="toggle-button" data-type="ENV2">ENV 2</div>
                        <div class="toggle-button" data-type="LFO2">LFO 2</div>
                        <div class="toggle-button" data-type="FILTER2">FILTER 2</div>
                        <div class="toggle-button" data-type="ENV3">ENV 3</div>
                        <div class="toggle-button" data-type="LFO3">LFO 3</div>
                        <div class="toggle-button" data-type="FILTER3">FILTER 3</div>
                    </div>
                </div>
            </div>
            <div id="LFO">
                <canvas id="LFOView" width="270px" height="100px"></canvas>
                <fieldset class="border-2 border-black w-[20] h-[130]">
                    <legend class="text-x1 font-bold text-black text-center px-2 p-0 m-0">LFO</legend>
                    <div id="LFO-rack" class="flex flex-row">
                        <div id="rate-rack"></div>
                    </div>
                </fieldset>
            </div>
        </div>
        <div style="display: flex; align-items: start;">
            <div id="envelope">
                <canvas id="envelopeView" width="390px" height="100px"></canvas>
                <fieldset class="border-2 border-black w-[20] h-[130]">
                    <legend class="text-x1 font-bold text-black text-center px-2 p-0 m-0">Envelope</legend>

                    <div id="envelope-rack" class="flex flex-col items-center md:flex-row"></div>
                </fieldset>
            </div>
<div id="filter">
                <canvas id="filterView" width="390px" height="100px"></canvas>
                <div style="display: flex; align-items: start;">
                    <fieldset class="border-2 border-black w-[20] h-[130]">
                        <legend class="text-x1 font-bold text-black text-center px-2 p-0 m-0">Filter</legend>

                        <div id="filter-rack" class="flex flex-col items-center md:flex-row"></div>
                    </fieldset>
                    <div class="button-container">
                        <div class="toggle-button" data-type="LP1">LP 1</div>
                        <div class="toggle-button" data-type="BP1">BP 1</div>
                        <div class="toggle-button" data-type="HP1">HP 1</div>
                        <div class="toggle-button" data-type="LP2">LP 2</div>
                        <div class="toggle-button" data-type="BP2">BP 2</div>
                        <div class="toggle-button" data-type="HP2">HP 2</div>
                        <div class="toggle-button" data-type="LP3">LP 3</div>
                        <div class="toggle-button" data-type="BP3">BP 3</div>
                        <div class="toggle-button" data-type="HP3">HP 3</div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Knob Component Container -->
    <div id="knob-component-num1" style="display: none;"
        class="knob-container bg-gray-200 p-[1.5rem] -my-[11rem] px-4 -mx-36 rounded-3xl shadow-lg text-center w-[24rem] transform scale-[0.20]">
        <!-- Title -->
        <h2 id="knob-title-num1" class="text-5xl font-bold text-gray-700 mb-12"></h2>

        <!-- Dial and Labels Wrapper -->
        <div class="relative w-48 h-48 mx-auto">
            <!-- Labels will be injected here by JavaScript -->
            <div id="knob-labels-num1" class="absolute inset-0"></div>

            <!-- The circular knob dial -->
            <div id="knob-dial-num1"
                class="absolute inset-[25%] bg-gray-500 rounded-full shadow-md cursor-pointer flex items-center justify-center">

                <!-- Larger Triangle Indicator -->
                <!--<div class="w-0 h-0 border-l-[14px] border-l-transparent border-r-[14px] border-r-transparent border-b-[22px] border-b-black transform translate-y-[-18px]"></div>-->

                <!-- Thin Line Indicator -->
                <div class="absolute top-2 left-1/2 -translate-x-1/2 w-3 h-[calc(50%-0.5rem)] bg-gray-900 rounded-full">
                </div>
            </div>
        </div>

        <!-- Value Input -->
        <div class="mt-6">
            <input id="knob-value-input-num1" type="number"
                class="w-34 text-center bg-white border border-gray-300 rounded-md p-2 text-6xl font-mono focus:outline-none focus:ring-2 focus:ring-blue-500">
        </div>
    </div>
    <script type="module" src="play.js"></script>

    <script type="module" src="components/toggle-button.js"></script>

    <!-- volume component -->
    <div id="volume-component-num1" style="display: none;"
        class="volume-container w-24 -mr-4 -ml-2 transform scale-[0.58] -my-7">
        <div class="volume-title">Volume</div>
        <div class="volume-slider-wrapper">
            <input type="range" class="volume-slider" id="volume-slider-num1" min="0" max="100" value="75">
        </div>
        <div class="volume-percentage" id="volume-label-num1"></div>
    </div>

    <!-- Rate Component Template (hidden, used for cloning) -->
    <div id="rate-component-template" style="display: none;"
        class="rate-container bg-gray-200 p-6 pl-[5rem] rounded-2xl shadow-lg text-center w-[32rem]">
        <!-- Title -->
        <h2 class="rate-title text-4xl font-bold text-gray-700">Rate</h2>

        <!-- Main Control Area -->
        <div class="rate-control-area">
            <!-- Frequency Input (shown when Mult is off) -->
            <div class="rate-frequency-mode">
                <div class="flex items-center justify-center mb-0">
                    <input type="number"
                        class="rate-freq-input w-[14rem] text-center bg-white border-2 border-gray-400 rounded-md px-3 py-2 text-4xl font-mono focus:outline-none focus:ring-2 focus:ring-blue-500"
                        value="0">
                    <span id="HertzLabel" class="ml-3 text-3xl font-medium text-gray-700">Hz</span>
                </div>
            </div>

            <!-- Multiplier Mode (shown when Mult is on) -->
            <div class="rate-mult-mode hidden">
                <div class="flex items-center justify-center space-x-4">
                    <div class="flex items-center bg-white border-2 border-gray-400 rounded-md">
                        <!-- Numerator -->
                        <div class="relative px-4 py-2">
                            <input type="number"
                                class="rate-numerator w-20 text-center text-4xl font-mono focus:outline-none" value="1"
                                min="1">
                            <div class="absolute -right-2 top-1/2 -translate-y-1/2 flex flex-col">
                                <button class="rate-num-up text-gray-600 hover:text-gray-900 -mb-2">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 6l6 9H6z" />
                                    </svg>
                                </button>
                                <button class="rate-num-down text-gray-600 hover:text-gray-900">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 18l-6-9h12z" />
                                    </svg>
                                </button>
                            </div>
                        </div>

                        <!-- Divider -->
                        <div class="text-4xl font-mono px-2">/</div>

                        <!-- Denominator -->
                        <div class="relative px-4 py-2">
                            <input type="number"
                                class="rate-denominator w-20 -translate-x-4 text-center text-4xl font-mono focus:outline-none"
                                value="1" min="1">
                            <div class="absolute -right-2 top-1/2 -translate-y-1/2 flex flex-col">
                                <button class="rate-denom-up text-gray-600 hover:text-gray-900 -translate-x-4 -mb-2">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 6l6 9H6z" />
                                    </svg>
                                </button>
                                <button class="rate-denom-down text-gray-600 hover:text-gray-900 -translate-x-4">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 18l-6-9h12z" />
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Mult Toggle Button -->
            <button
                class="rate-mult-toggle mb-6 px-6 py-3 mx-6 bg-gray-700 text-white text-2xl font-medium rounded-lg hover:bg-gray-800 transition-colors">
                Mult
            </button>
        </div>

        <div class="rate-slider-container mt-2">
            <div class="flex items-center space-x-4">
                <input type="range" class="rate-slider flex-1" min="0" max="100" value="0" step="0.01">
            </div>
        </div>
    </div>

    <!-- open sample -->
    <div id="preset-loader" class="preset-row">
        <!-- folder icon -->
        <button id="openSampleBtn" class="folder-btn" aria-label="Open preset samples">
            <input id="openSampleInput" type="file" accept="audio/*" id="myFile" hidden>
            <img src="icons/folder.png" alt="" class="folder-icon" width="24" height="24">
        </button>
        <!-- sample selection -->
        <select style="cursor:pointer;" title="Choose a preset" id="sampleSelect" class="preset-select">
            <option disabled selected value="">Choose a preset</option>
        </select>
        <!-- play button -->
        <button id="playSampleBtn" class="play-btn" disabled>▶ Play</button>
    </div>

    <!-- Oscillator type dropdown -->
    <div class="osc-header">
        <span class="osc-title">OSC 1</span>
        <select id="osc1Type" class="osc-dropdown" aria-label="Oscillator 1 type">
            <option value="sample" selected>Sample</option>
            <option value="waveform">Waveform</option>
            <option value="wavetable">Wavetable</option>
        </select>
    </div>
    <script type="module" src="components/oscillator-dropdown.js"></script>

    <script type="module" data-main="js/main" src="warp.js"></script>
</body>

</html>